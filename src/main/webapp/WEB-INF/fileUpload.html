<!DOCTYPE html>
<html>
<meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="format-detection" content="telephone=yes">
<head>
    <meta charset="UTF-8">
    <title>上传证件</title>
    <style>
        body {
            margin: 20px 20%;
            color:#777;
            text-align: center;
        }
        #result{
            margin-top: 20px;
        }
    </style>
</head>
<body>
<h1 class="text-center">上传证件...</h1>
<hr/>
<input id="image" type="file"  onclick="check()" />
<div id="result" align="center">
    上传结果
</div>
<hr/>

<!-- 引入jQuery -->
<script type="text/javascript" src="dist/js/jquery.min.js"></script>
<script type="text/javascript" src="../js/LocalResizeIMG.js"></script>

<!-- mobileBUGFix.js 兼容修复移动设备 -->
<script src="../js/mobileBUGFix.mini.js" type="text/javascript"></script>
<script type="text/javascript">
    $("input:file").localResizeIMG({
        width: 500,
        quality: 0.8,
        success: function (result) {
            var img = new Image();
            img.src = result.base64;
            console.log(result.clearBase64);
            //$("body").append(img);
            $("#result").empty();
            $("#result").append(img); //呈现图像(拍照結果)
            $.ajax({
                url: "upLoadImageServlet",
                type: "POST",
                data:{formFile:result.clearBase64},
                dataType: "HTML",
                timeout: 1000,
                error: function(){
                    alert("Error loading PHP document");
                },
                success: function(result){
                    //alert(result);
                    //console.log(result);
                    alert("Uploads success~")
                }
            });
        }
    });
    function check(){
        var reader = new FileReader();
        var AllowImgFileSize = 2100000; //上传图片最大值(单位字节)（ 2 M = 2097152 B ）超过2M上传失败
        var file = $("#image")[0].files[0];
        var imgUrlBase64;
        imgUrlBase64 = reader.readAsDataURL(file);
        if (file) {
            //将文件以Data URL形式读入页面
            imgUrlBase64 = reader.readAsDataURL(file);
            reader.onload = function (e) {
                //var ImgFileSize = reader.result.substring(reader.result.indexOf(",") + 1).length;//截取base64码部分（可选可不选，需要与后台沟通）
                if (AllowImgFileSize != 0 && AllowImgFileSize < reader.result.length) {
                    alert( '上传失败，请上传不大于2M的图片！');
                    return;
                }else{
                    //执行上传操作
                    console(reader.result);

//                  alert(reader.result);
                }
            }
        }
    }
    function base(picObj){
        alert("111111");
        var reader = new FileReader();
        var AllowImgFileSize = 2100000; //上传图片最大值(单位字节)（ 2 M = 2097152 B ）超过2M上传失败
        var file = $("#image")[0].files[0];
        var imgUrlBase64;
        if (file) {
            //将文件以Data URL形式读入页面
            imgUrlBase64 = reader.readAsDataURL(file);
            reader.onload = function (e) {
                //var ImgFileSize = reader.result.substring(reader.result.indexOf(",") + 1).length;//截取base64码部分（可选可不选，需要与后台沟通）
                if (AllowImgFileSize != 0 && AllowImgFileSize < reader.result.length) {
                    alert( '上传失败，请上传不大于2M的图片！');
                    return;
                }else{
                    //执行上传操作
//                  console(reader.result);

//                  alert(reader.result);
                }
            }
        }
    }

</script>
</body>
</html>